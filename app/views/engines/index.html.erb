<%####### Devise notices ######%>
<div class="devise-msg connect">
  <div class="devise-msg__close"><i class="fas fa-times"></i></div>
  <p id="notice"><%= notice %></p>
</div>

<%###### Start Module Index Engines #####%>
<div class="mod mod-engines-index">
  <div class="container">
    <%# Row heading %>
    <div class="row mod__heading">
      <div class="col-md-12">
        <h1>Parc machines <% if params[:tag] %>- <%= params[:tag] %><% end %></h1>
      </div>
    </div>
    <%# Row Features %>
    <div class="row">
      <div class="col-md-12">
        <div class="mod-engines-index__features">
          <%# Filters feature %>
          <div class="mod-engines-index__filters">
            <div class="mod-engines-index__filter tag">
              <span>Filtrer par :</span>
              <span class="filter-item-select">
                <span class="filter-item-select__btn"><% if params[:tag] %><%= params[:tag] %><% else %>Choisir<% end %> <i class="fas fa-chevron-down"></i></span>
                <ul class="filter-item-select__dropdown">
                  <li><a class="d-block" href="/engines">Tous</a></li>
                  <% @tags.map(&:name).map.each do |t| %>
                  <li><a class="d-block" href="<%= tag_path(t) %>"><%= t %></a></li>
                  <% end %>
                </ul>
              </span>
            </div>           
          </div>
          <%# Add Engine %>
        </div>
      </div>
    </div>
    <%# Row Engines List %>
    <div class="row">
      <% @engines.each do |engine| %>
      <div class="col-md-12 engine-card">
        <div class="engine-card__inner d-flex align-items-center">
            <%# Engine name %>
            <div class="engine-card__name">
              <% if engine.name != "" %>
              <%= link_to engine.name, engine %>
              <% else %>
              <%= link_to engine.internal_name, engine %>
              <% end %>
            </div>
            <%# Engine categories %>
            <div class="engine-card__categories">
              <% engine.tags.map(&:name).map.each do |t| %>
              <a href="<%= tag_path(t) %>"><i class="fas fa-tag"></i><%= t %></a>
              <% end %>
            </div>
            <%# Engine actions %>
            <div class="engine-card__actions">
              <span class="engine-card__action-btn">
                <i class="fas fa-cog"></i>
                <div class="engine-card__action-items">
                  <%= link_to 'Voir', engine %>
                  <%= link_to 'Mettre à jour', edit_engine_path(engine) %>
                  <%= link_to 'Supprimer', engine, method: :delete, data: { confirm: 'Are you sure?' } %>
                </div>
              </span>
            </div>
        </div>
      </div>
      <% end %>
    </div>
  </div>
  

  <br>
  <% if user_signed_in? %>
  <%= link_to 'Ajouter une machine', new_engine_path %>
  <br>
  <%= link_to 'Voir les familles', tags_path %>
  <br>
  <%= link_to "Modifier mon compte", edit_user_registration_path(current_user) %>
  <br>
  <%= link_to "Mon compte", user_path(current_user) %>
  <br>
  <%= link_to "Déconnexion", destroy_user_session_path, method: :delete %>
  <% else %>
  <%= link_to 'Connectez-vous', new_user_session_path %>
  <% end %>
</div>